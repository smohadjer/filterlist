{
  "version": 3,
  "sources": ["../src/filterList.js"],
  "sourcesContent": ["'use strict';\n\nexport default class FilterList {\n\tconstructor(options) {\n\t\tthis.element = options.element;\n\t\tthis.urlIsUpdatable = options.urlIsUpdatable || false;\n\t\tthis.filters = [];\n\t\tthis.filterNames = this.element.getAttribute('data-filter-names').split(' ');\n\t\tthis.initCallback = options.initCallback;\n\t\tthis.filtersCallback = options.filtersCallback;\n\t\tthis.lastClass = options.lastClass || 'last';\n\t\tthis.hiddenClass = options.hiddenClass;\n\t\tthis.excludeClass = options.excludeFromFilteringClass || 'filterList__exclude';\n\n\t\tthis.setEventHandlers();\n\t\tthis.setDefaultFilters(this.filterNames);\n\t\tthis.updateFiltersfromURL();\n\t\tthis.updateBrowserHistory();\n\n\t\tif (typeof this.initCallback === 'function') {\n\t\t\tthis.initCallback();\n\t\t}\n\n\t\tthis.applyFilters(this.element);\n\t}\n\n\tupdateBrowserHistory() {\n\t\tif (this.urlIsUpdatable) {\n\t\t\thistory.replaceState({filters: this.filters}, document.title, window.location.href);\n\t\t}\n\t}\n\n\tsetDefaultFilters(filterNames) {\n\t\tfilterNames.forEach((filterName) => {\n\t\t\tconst ignoreValue = this.getFilterIgnoreValue(filterName);\n\t\t\tconst filterValue = this.getFilterValue(filterName);\n\n\t\t\tthis.filters.push({\n\t\t\t\tname: filterName,\n\t\t\t\tvalue: filterValue,\n\t\t\t\tignoreValue: ignoreValue\n\t\t\t});\n\t\t});\n\t}\n\n\tgetFilterIgnoreValue(filterName) {\n\t\tconst filterElement = document.querySelector(`[name=\"${filterName}\"]`);\n\t\tlet ignoreValue;\n\n\t\tif (filterElement) {\n\t\t\tif (filterElement.tagName === 'SELECT') {\n\t\t\t\tignoreValue = filterElement.getAttribute('data-ignore');\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn('No filter with name ' + filterName + ' was found in markup!');\n\t\t}\n\n\t\treturn ignoreValue;\n\t}\n\n\tgetFilterValue(filterName) {\n\t\tconst filterElement = document.querySelector(`[name=\"${filterName}\"]`);\n\t\tlet filterValue;\n\n\t\tif (filterElement) {\n\t\t\tif (filterElement.getAttribute('type') === 'checkbox') {\n\t\t\t\tfilterValue = filterElement.checked ? filterElement.value : undefined;\n\t\t\t} else {\n\t\t\t\tfilterValue = filterElement.value;\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn('No filter with name ' + filterName + ' was found in markup!');\n\t\t}\n\n\t\treturn filterValue;\n\t}\n\n\tupdateFiltersfromURL() {\n\t\tthis.filterNames.forEach((filterName) => {\n\t\t\tconst searchParams = new URLSearchParams(window.location.search);\n\t\t\tconst newValue = searchParams.get(filterName);\n\n\t\t\tif (newValue) {\n\t\t\t\tthis.updateFilters({\n\t\t\t\t\tname: filterName,\n\t\t\t\t\tvalue: newValue\n\t\t\t\t});\n\n\t\t\t\tthis.updateDOM(this.filters);\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateFilters(updatedFilter) {\n\t\tlet filter = this.filters.find((filter) => filter.name === updatedFilter.name);\n\n\t\tif (filter && filter.value !== updatedFilter.value) {\n\t\t\tfilter.value = updatedFilter.value;\n\t\t\tthis.applyFilters(this.element);\n\t\t}\n\t}\n\n\tsetEventHandlers() {\n\t\tthis.filterNames.forEach((filterName) => {\n\t\t\tconst filterElement = document.querySelector('[name=\"' + filterName + '\"]');\n\n\t\t\tif (filterElement) {\n\t\t\t\tfilterElement.addEventListener('change', () => {\n\t\t\t\t\tthis.updateFilters({\n\t\t\t\t\t\tname: filterName,\n\t\t\t\t\t\tvalue: this.getFilterValue(filterName)\n\t\t\t\t\t});\n\n\t\t\t\t\tif (this.urlIsUpdatable) {\n\t\t\t\t\t\tconst url = this.updateURL(new URL(window.location.href), this.filters);\n\t\t\t\t\t\thistory.pushState({filters: this.filters}, document.title, url);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif (this.urlIsUpdatable && window.history && window.history.pushState) {\n\t\t\twindow.addEventListener(\"popstate\", (e) => {\n\t\t\t\tif (e.state.filters) {\n\t\t\t\t\tfor (let prop in e.state.filters) {\n\t\t\t\t\t\tthis.filters[prop] = e.state.filters[prop];\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.updateDOM(e.state.filters);\n\t\t\t\t\tthis.applyFilters(this.element);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tupdateDOM(filters) {\n\t\tfilters.forEach((filter) => {\n\t\t\tconst element = document.querySelector(`[name=\"${filter.name}\"]`);\n\t\t\tif (element) {\n\t\t\t\tif (element.tagName === 'SELECT') {\n\t\t\t\t\telement.value = filter.value;\n\t\t\t\t} else if (element.tagName === 'INPUT') {\n\t\t\t\t\tif (element.getAttribute('type') === 'checkbox') {\n\t\t\t\t\t\telement.checked = (element.value === filter.value) ? true : false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t//public method for changing filters via other scripts\n\tsetFilters(filters) {\n\t\tfor (let property in filters) {\n\t\t\tthis.filters.forEach(function(item) {\n\t\t\t\tif (item.name === property) {\n\t\t\t\t\titem.value = filters[property];\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tthis.updateDOM(this.filters);\n\t\tthis.applyFilters(this.element);\n\n\t\tif (this.urlIsUpdatable) {\n\t\t\tconst url = this.updateURL(new URL(window.location.href), this.filters);\n\t\t\thistory.pushState({filters: this.filters}, document.title, url);\n\t\t}\n\t}\n\n\t// returns elements that match all applicable filters\n\tgetMatchedItems(listItems) {\n\t\tconst matchedItems = [];\n\t\tlistItems.forEach((element) => {\n\t\t\tlet matched = true;\n\n\t\t\t// exclude filters that are not set or have ignoreValue as they play no role in filtering\n\t\t\tconst applicableFilters = this.filters.filter((item) => {\n\t\t\t\treturn item.value !== undefined && item.value !== item.ignoreValue;\n\t\t\t});\n\n\t\t\tapplicableFilters.forEach((filter) => {\n\t\t\t\t\tconst hasThisFilter = element.hasAttribute('data-filter-' + filter.name);\n\t\t\t\t\tconst filterValue =  element.getAttribute('data-filter-' + filter.name);\n\n\t\t\t\t\tif (!hasThisFilter || !filterValue.split(' ').includes(filter.value)) {\n\t\t\t\t\t\tmatched = false;\n\t\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (matched) {\n\t\t\t\tmatchedItems.push(element);\n\t\t\t}\n\t\t});\n\n\t\treturn matchedItems;\n\t}\n\n\tapplyFilters(element) {\n\t\tconst listItems = [...element.children].filter((item) => {return !item.classList.contains(this.excludeClass)});\n\t\tconst matchedItems = this.getMatchedItems(listItems);\n\n\t\t// hide all items\n\t\tlistItems.forEach((el) => {\n\t\t\tthis.hiddenClass ? el.classList.add(this.hiddenClass) :\n\t\t\t\tel.setAttribute('hidden', 'hidden');\n\t\t});\n\n\t\t// unhide matched items\n\t\tif (matchedItems.length === 0) {\n\t\t\telement.classList.add('is-empty');\n\t\t} else {\n\t\t\tmatchedItems.forEach((item) => {\n\t\t\t\tthis.hiddenClass ? item.classList.remove(this.hiddenClass) :\n\t\t\t\t\titem.removeAttribute('hidden');\n\t\t\t});\n\t\t\telement.classList.remove('is-empty');\n\t\t}\n\n\t\t//add a class to last visible item\n\t\tif (this.lastClass) {\n\t\t\tconst lastVisibleElement = element.querySelector(`.${this.lastClass}`);\n\t\t\tif (lastVisibleElement) {\n\t\t\t\tlastVisibleElement.classList.remove(this.lastClass);\n\t\t\t}\n\t\t\tmatchedItems[matchedItems.length - 1].classList.add(this.lastClass);\n\t\t}\n\n\t\tif (typeof this.filtersCallback === 'function') {\n\t\t\tthis.filtersCallback();\n\t\t}\n\t}\n\n\t// url is a URL object\n\tupdateURL(url, filters) {\n\t\tfilters.forEach((filter) => {\n\t\t\tif (filter.value === undefined ||\n\t\t\t\tfilter.value.length === 0 ||\n\t\t\t\tfilter.value === filter.ignoreValue) {\n\t\t\t\turl.searchParams.delete(filter.name);\n\t\t\t} else {\n\t\t\t\turl.searchParams.set(filter.name, filter.value);\n\t\t\t}\n\t\t});\n\n\t\treturn url;\n\t}\n}\n"],
  "mappings": "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",
  "names": ["FilterList", "options", "filterNames", "filterName", "ignoreValue", "filterValue", "filterElement", "newValue", "updatedFilter", "filter", "url", "prop", "filters", "element", "property", "item", "listItems", "matchedItems", "matched", "hasThisFilter", "el", "lastVisibleElement"]
}
